#!/bin/bash

#
# Dynamically generated by Chef on <%= node["fqdn"] %>
#
# Local modifications will be overwritten by Chef.
#

SWAP_SIZE_MEGABYTES="<%= node["swapfile"]["swap_size_megabytes"] %>"

if [ -z "$SWAP_SIZE_MEGABYTES" ];then
  echo No swap size given, skipping.
else  
  if [ -e /swapfile ];then    
     echo /swapfile already exists.  Skipping.  
  else    
     echo Creating /swapfile of "$SWAP_SIZE_MEGABYTES" Megabytes    
     dd if=/dev/zero of=/swapfile bs=1024 count=$(($SWAP_SIZE_MEGABYTES*1024))    
     mkswap /swapfile    
     swapon /swapfile    
     echo Swap Status:    
     swapon -s  
  fi
fi
